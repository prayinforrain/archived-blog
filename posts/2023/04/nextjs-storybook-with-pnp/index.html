<!doctype html><html lang=ko><head><meta charset=utf-8><meta http-equiv=content-type content="text/html"><meta name=viewport content="width=device-width,initial-scale=1"><title itemprop=name>Next.js Storybook에 Yarn PnP 적용하기 | PrayinForRain.dev</title>
<meta property="og:title" content="Next.js Storybook에 Yarn PnP 적용하기 | PrayinForRain.dev"><meta name=twitter:title content="Next.js Storybook에 Yarn PnP 적용하기 | PrayinForRain.dev"><meta itemprop=name content="Next.js Storybook에 Yarn PnP 적용하기 | PrayinForRain.dev"><meta name=application-name content="Next.js Storybook에 Yarn PnP 적용하기 | PrayinForRain.dev"><meta property="og:site_name" content="PrayinforRain.dev"><meta name=description content="Dev blog of PrayinForRain, a KR frontend engineer"><meta itemprop=description content="Dev blog of PrayinForRain, a KR frontend engineer"><meta property="og:description" content="Dev blog of PrayinForRain, a KR frontend engineer"><meta name=twitter:description content="Dev blog of PrayinForRain, a KR frontend engineer"><meta property="og:locale" content="ko"><meta name=language content="ko"><link rel=alternate hreflang=ko href=https://prayinforrain.github.io/posts/2023/04/nextjs-storybook-with-pnp/ title><meta itemprop=image content="https://prayinforrain.github.io/avatar.png"><meta property="og:image" content="https://prayinforrain.github.io/avatar.png"><meta name=twitter:image content="https://prayinforrain.github.io/avatar.png"><meta name=twitter:image:src content="https://prayinforrain.github.io/avatar.png"><meta property="og:type" content="article"><meta property="og:article:published_time" content=2023-04-27T15:32:50+0900><meta property="article:published_time" content=2023-04-27T15:32:50+0900><script defer type=application/ld+json>{"@context":"http://schema.org","@type":"Article","headline":"Next.js Storybook에 Yarn PnP 적용하기","author":{"@type":"Person","name":""},"datePublished":"2023-04-27","description":"","wordCount":937,"mainEntityOfPage":"True","dateModified":"2023-04-27","image":{"@type":"imageObject","url":""},"publisher":{"@type":"Organization","name":"PrayinForRain.dev"}}</script><meta name=generator content="Hugo 0.135.0"><link rel=canonical href=https://prayinforrain.github.io/posts/2023/04/nextjs-storybook-with-pnp/><link href=/style.min.b986244e2fb36964e8f831c45e69cf0e3e208d4d9bf6b5eaf4caddc81dc0ba31.css rel=stylesheet><link href=/code-highlight.min.731e9fc351d3c45d032fb5f574575c296f67e08c1c6229b5ccbfd7bfb18217c5.css rel=stylesheet><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/icons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/icons/favicon-16x16.png><link rel=mask-icon href=/icons/safari-pinned-tab.svg><link rel="shortcut icon" href=/favicon.ico><link rel=manifest href=https://prayinforrain.github.io/site.webmanifest><meta name=msapplication-config content="/browserconfig.xml"><meta name=msapplication-TileColor content="#2d89ef"><meta name=theme-color content="#434648"><link rel=icon type=image/svg+xml href=/icons/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-63GYNX3VF5"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-63GYNX3VF5")}</script><script type=text/javascript src=//wcs.naver.net/wcslog.js></script><script type=text/javascript>if(!wcs_add)var wcs_add={};wcs_add.wa="1940c9395811670",window.wcs&&location.host==="prayinforrain.github.io"&&wcs_do()</script></head><body data-theme=auto class=notransition><script src=/js/theme.min.d17e61995c7d9fee9a7b0e77c95447101fe27fa434c458fab370732da48b2b17.js integrity="sha256-0X5hmVx9n+6aew53yVRHEB/if6Q0xFj6s3BzLaSLKxc="></script><div class=navbar role=navigation><nav class=menu aria-label="Main Navigation"><a href=https://prayinforrain.github.io/ class=logo><svg width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><title>Home</title><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
</a><input type=checkbox id=menu-trigger class=menu-trigger>
<label for=menu-trigger><span class=menu-icon><svg width="25" height="25" stroke="currentcolor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7H3.40726"/><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488H3.49301"/><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"/><path stroke-linecap="round" stroke-linejoin="round" d="M.5 12.5V1.5c0-.552285.447715-1 1-1h11C13.0523.5 13.5.947715 13.5 1.5v11C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C.947715 13.5.5 13.0523.5 12.5z"/></svg></span></label><div class=trigger><ul class=trigger-container><li><a class=menu-link href=/>Home</a></li><li><a class="menu-link active" href=/posts/>Posts</a></li><li><a class=menu-link href=/tags/>Tags</a></li><li><a class=menu-link href=/about/>About</a></li><li class=menu-separator><span>|</span></li></ul><a id=mode href=#><svg class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1"><title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1=".5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1=".5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/></g></svg><svg class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1"><title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1=".5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1=".5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/></g></svg></a></div></nav></div><div class="wrapper post"><main class=page-content aria-label=Content><article><header class=header><h1 class=header-title>Next.js Storybook에 Yarn PnP 적용하기</h1><div class=post-meta><time datetime=2023-04-27T15:32:50+09:00 itemprop=datePublished>2023. 4. 27.</time></div></header><details class=toc><summary><b>Table of Contents</b></summary><nav id=TableOfContents><ul><li><a href=#storybook을-쓰려고-했는데>Storybook을 쓰려고 했는데</a></li><li><a href=#그럼-쓰세요>그럼 쓰세요</a><ul><li><a href=#create-next-app으로-프로젝트-준비>create-next-app으로 프로젝트 준비</a></li><li><a href=#storybook-설치하기>Storybook 설치하기</a></li><li><a href=#하지만-node_modules가-생기잖아요>하지만 node_modules가 생기잖아요</a></li></ul></li><li><a href=#내가-이겼다-스토리북아>내가 이겼다 스토리북아</a></li><li><a href=#refs>Refs.</a></li></ul></nav></details><div class=page-content><h2 id=storybook을-쓰려고-했는데>Storybook을 쓰려고 했는데</h2><p>최근 Storybook을 사용할 일이 무척 많았다. 언젠가는 포스팅을 해야 할 CDS 프로젝트부터 <a href=https://prayinforrain.github.io/posts/2023/04/numble-talk/>넘블 챌린지</a>도 있었고&mldr; 처음엔 너무 낯설었지만 공통된 컴포넌트들을 미리 설계해 두고 재사용하는 것이 좀 더 깔끔한 설계가 되는 것 같아 매력을 느꼈다.</p><p>그런데 문제는 내 작업 환경에 있었다. 꽤 연식이 된 윈도우 데스크탑에 수십가지 개발 환경을 섞어 놓고, 요새는 게임에도 못 쓰는 처참한 성능의 HDD에 레포를 두고 쓰니 종속성 패키지 설치도 커피 한 잔 타와야 하는 시간이 걸리니 Yarn Berry의 사용이 반필수가 되어버렸다. 넘블 챌린지 때 Yarn Berry를 사용하고 싶었지만 애석하게도 수 많은 문제에 시달려 포기했는데, 여유가 생긴 지금 마음을 다잡고 다시 시도해 보기로 했다.</p><blockquote><p>Yarn Berry의 가장 큰 변화는 Plug n Play 방식의 패키지 관리 방식을 지원한다는 점이지, <code>Yarn Berry = PnP</code>인 것은 아니다. Yarn Berry도 nodeLinker 옵션을 <code>node-modules</code>로 지정한다면 node<em>modules 디렉토리를 사용할 수 있기 때문에, 아래부터는 _Berry</em> 대신 <em>PnP</em> 라는 표현을 사용하였다.</p></blockquote><h2 id=그럼-쓰세요>그럼 쓰세요</h2><h3 id=create-next-app으로-프로젝트-준비>create-next-app으로 프로젝트 준비</h3><p>우선 Next.js 앱을 생성하고, Yarn PnP로 패키지 매니저를 변경해 보자.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>yarn create next-app
</span></span><span class=line><span class=cl>yarn <span class=nb>set</span> version berry <span class=c1>## yarn pnp로 패키지 매니저 변경</span>
</span></span></code></pre></div><p>PnP를 사용하기 위해 yarn의 설정을 변경해 주어야 한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl><span class=c1>## .yarnrc.yml</span>
</span></span><span class=line><span class=cl>nodeLinker: pnp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## terminal</span>
</span></span><span class=line><span class=cl>yarn plugin import typescript <span class=c1>## @types 패키지를 자동으로 설치해 주는 플러그인</span>
</span></span><span class=line><span class=cl>yarn <span class=c1>## 자동으로 node_modules가 삭제되고 패키지가 다시 설치된다.</span>
</span></span><span class=line><span class=cl>yarn dlx @yarnpkg/sdks vscode <span class=c1>## VSCode에서 Repository의 Typescript를 사용하기 위한 명령어</span>
</span></span></code></pre></div><p>기본적인 환경 설정이 완료되었다.</p><h3 id=storybook-설치하기>Storybook 설치하기</h3><h4 id=initialize>Initialize</h4><p><a href=https://storybook.js.org/docs/react/migration-guide#automatic-upgrade>Storybook 공식 문서</a>를 따라서 설치해 보겠다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>yarn dlx storybook@latest init
</span></span></code></pre></div><p>설치는 제대로 되었지만, <code>yarn storybook</code>을 실행해 보면 오류가 난다. 이는 Yarn Berry의 엄격 모드(Strict mode)에서는 명시적으로 나열되지 않은 종속성을 자동으로 설치하지 않기 때문이다.<br>무슨 말일까? 대충 내 프로젝트에서 A 패키지를 설치하면, A 패키지에서 사용하는 B 패키지가 함께 설치되지 않을 수 있다는 뜻이다. 정확히 어떤 기준인지는 파악하지 못했지만 이 문제로 인해 babel을 포함한 일부 패키지들이 설치되지 않는다. 아마 React 앱의 경우 대부분 babel + webpack을 사용하고 있을테고 Storybook은 여기 달려있는 babel을 같이 사용하려고 하는 게 아닐까..(추상적인 생각)</p><p>이를 해결하기 위해서는 무한 리트를 하면서 요구하는 종속성을 하나씩 설치하거나, <code>.yarnrc.yml</code> 파일에 아래와 같은 설정을 추가하여 엄격 모드를 해제하여 해결할 수 있다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl><span class=c1>## .yarnrc.yml</span>
</span></span><span class=line><span class=cl>pnpMode: loose
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 다시 종속성 패키지 설치</span>
</span></span><span class=line><span class=cl>yarn
</span></span></code></pre></div><p>그리고 어째서인지 느슨한 모드로 재설치를 해도 오류를 일으키는 <code>styled-jsx</code>와 <code>@babel/core</code>를 설치해 주겠다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>yarn add -D @babel/core styled-jsx
</span></span></code></pre></div><h4 id=webpack의-설정을-고치기>Webpack의 설정을 고치기</h4><p>다시 실행해 보면 스토리북 화면이 나타난다. 하지만 무언가의 오류가 표시되며 스토리북 dev server가 꺼져 버린다.</p><p><img src=/images/posts/2023/04/nextjs-storybook-with-pnp/02.png alt="css loader error"></p><p><code>@storybook/nextjs</code>의 번들러인 webpack에서 css-loader와 기타등등 플러그인을 불러오면서 오류가 생기는 모양이다. 특이하게도 이 오류는 PnP 환경에서만 발생하는 오류인데, 대충 이 빌더에서 <a href=https://github.com/storybookjs/storybook/blob/next/code/frameworks/nextjs/src/css/webpack.ts#L71>webpack의 css-loader 관련 설정을 만드는 부분</a>을 살펴보면 이런 추측을 할 수 있다.</p><ol><li><code>configureCss</code> 함수에서 <code>options.url</code>을 포함한 기타등등을 담은 설정 객체를 만든다.</li><li>이 과정에서 <code>getImportAndUrlCssLoaderOptions</code>함수를 거쳐 <code>getUrlResolver</code> 함수가 호출된다.</li><li><code>getUrlResolver</code>는 NextConfig 객체의 experimental property를 참조한다. experimental은 아래와 같은 타입을 갖는다.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kr>interface</span> <span class=nx>ExperimentalConfig</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>urlImports?</span>: <span class=kt>NonNullable</span><span class=p>&lt;</span><span class=nt>webpack.Configuration</span><span class=err>[&#34;</span><span class=na>experiments</span><span class=err>&#34;]</span><span class=p>&gt;[</span><span class=s2>&#34;buildHttp&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><ol start=4><li>이 경로를 이용해 css 파일의 위치를 특정하고 번들링한다.</li></ol><p>대충 이 과정을 거치는 것으로 보이는데(확실하지 않음), 이 부분이 실험적 기능이다 보니 가상 경로를 참조하는 PnP 환경에서 제대로 작동하지 않을 확률이 가장 높아 보인다.
또는 Webpack의 버전이 v6인지 확인하기 위해 사용되는 <a href=https://github.com/storybookjs/storybook/blob/next/code/frameworks/nextjs/src/utils.ts#L96><code>scopedResolve</code> 함수</a>가 제대로 작동하지 않아서 객체가 이전 버전의 형식으로 생성되었을 수도 있겠다.</p><p>그래서 이걸 어떻게 고쳤냐면.. storybook의 <code>preset-scss</code> addon으로 이 부분의 설정을 덮어 씌워서 해결했다. 사실 이런 용도로 쓰는 게 아닐거라 생각하는데.. webpack 설정을 override해서 해결하는 것보다 이 쪽이 훨씬 더 비용이 저렴하다 생각했다. 만약 직접 해결하고자 한다면 <a href=https://storybook.js.org/docs/react/builders/webpack>Storybook의 Webpack 설정 문서</a>를 참고하여 설정을 할 수 있다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>yarn add --dev @storybook/preset-scss css-loader
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// .storybook/main.ts
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>addons</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=s2>&#34;@storybook/preset-scss&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span></code></pre></div><p><img src=/images/posts/2023/04/nextjs-storybook-with-pnp/03.png alt="storybook launched"><br>이제 정상적으로 스토리북이 실행될 것이다.</p><h4 id=maints의-타입-오류>main.ts의 타입 오류</h4><p><img src=/images/posts/2023/04/nextjs-storybook-with-pnp/01.png alt="framework name type error"></p><p>처음 init 했을 때부터 계속 거슬렸는데, <code>@storybook/nextjs</code> 템플릿이 <code>.storybook/main.ts</code> 파일을 생성할 때 프레임워크명을 절대경로를 포함해서 생성하면서 타입 오류가 나는 문제가 있다. 모순적이게도 <code>@storybook/nextjs</code>의 <code>StorybookConfig</code> 객체 타입은 이 부분에 무조건 <code>@storybook/nextjs</code>라는 문자열만을 허용하고 있다. 물론 그냥 실행이 되긴 하는데, 계속 붉은 줄이 그어져 있으면 몹시 곤란하니 이것도 바꿔 주겠다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// main.ts
</span></span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>framework</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;@storybook/nextjs&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>options</span><span class=o>:</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span></code></pre></div><h3 id=하지만-node_modules가-생기잖아요>하지만 node_modules가 생기잖아요</h3><p><img src=/images/posts/2023/04/nextjs-storybook-with-pnp/04.png alt="node_modules folder"></p><p>storybook 뿐 아니라 여러 패키지에서 발생하는 일인데, PnP모드에서도 스토리북을 실행하면 node_modules 디렉토리가 생성되는 것을 볼 수 있다. 이 안에는 대충&mldr; 스토리북 dev 서버 실행에 필요한 임시 파일들이 저장되어 있다. 나를 포함해서 많은 Yarn PnP 사용자들이 이 현상에 대해 불편함(?)을 겪고 있는데, Storybook의 기여자가 <a href=https://github.com/storybookjs/storybook/issues/11113#issuecomment-642851848>이슈 댓글</a>에서 다음과 같은 근거를 이야기해 주었다.</p><ul><li><code>node_modules/.cache/package-name</code>에 임시 파일을 저장하는 것은 여러 라이브러리에서 사용하고 있는 패턴이다.</li><li><code>node_modules</code>는 모든 Javascript/Typescript 프로젝트에서 <code>.gitignore</code>로 무시되고 있다.</li><li><code>node_modules</code>에는 보통 언제든 <em>지울 수 있는</em> 파일들이 들어가 있고, 문제 발생 시 이를 해결하기 위해 자주 삭제된다.</li><li>현재 시점에서 NPM, Yarn(PnP 사용 여부에 관계 없이) 모두에서 제대로 작동하고 있다.</li></ul><p>따라서 이 것이 문제가 되는 <em>버그</em> 는 아니고, <strong>기대된 동작(Expected Behavior)</strong> 으로 생각할 수 있다는 듯 하다. 댓글에 보면 Yarn 레포지토리 이슈에 이 캐시 파일들을 제거하기 위한 내용이 올라와 있는데, 3년이 지난 지금까지 참조 또는 갱신되지 않는 것으로 보아 급한 문제가 아니어서 잠정 보류된 모양이다. 좀 해 주면 좋을텐데..쩝..</p><h2 id=내가-이겼다-스토리북아>내가 이겼다 스토리북아</h2><p>앞서 말한 내 상황 때문에 나는 주변에 꽤나 Yarn berry 처돌이(?)로 퍼져 있는데 정작 프로젝트 할 때에는 한정된 시간 안에서 더 이상 지체할 수가 없어 node_modules를 사용해야 하는 것이 너무 아쉬웠다. 이미 프로젝트가 모두 정리된 후지만 그래도 지금에 와서나마 문제를 해결할 수 있어서 그래도 다행이다.</p><p>하나 속상한 에피소드가 있는데.. <a href=https://storybook.js.org/recipes/next>내가 처음에 봤던 instruction</a>에서 <code>npx</code> 커맨드만을 이야기하고 있고, 나는 <code>npx</code>가 npm과 yarn 중 상황에 맞는 패키지 매니저를 알아서 선택해 준다고 알고 있었기 때문에 의심 없이 사용했다가 에러를 하나 더 만나 조금 더 고생했다.<br>그러다가 바로 얼마 전에 <a href=https://github.com/storybookjs/storybook/issues/21895>공식 문서에서 누락된 부분이 수정된 PR</a>을 발견했는데.. 스토리북 초기화는 <code>yarn dlx storybook</code> 명령어를 사용해야 하는 모양이다. npx로 해도 해결 과정에 큰 차이는 없지만 아이고 속터져</p><h2 id=refs>Refs.</h2><ul><li><a href=https://woong-jae.com/projects/220711-pnp-dependency-error>Yarn PnP 의존성 에러 해결기 | 햣 블로그</a></li><li><a href=https://storybook.js.org/recipes/next>Integrate Next.js and Storybook | Storybook</a></li><li><a href=https://storybook.js.org/docs/react/addons/install-addons#using-preset-addons>Install Addons | Storybook</a></li><li><a href=https://storybook.js.org/docs/react/builders/webpack>Webpack | Storybook</a></li><li><a href=https://github.com/storybookjs/storybook/issues/21895>[Bug]: <code>storybook init</code> (v7) fails with Yarn PnP · Issue #21895 · storybookjs/storybook · GitHub</a></li><li><a href=https://github.com/storybookjs/storybook/issues/11113>&lsquo;yarn start-storybook&rsquo; creates node_modules/.cache in Yarn 2 PnP project · Issue #11113 · storybookjs/storybook · GitHub</a></li></ul></div></article><article id=giscus-wrapper></article><script>const giscus_light="https://cdn.jsdelivr.net/gh/prayinforrain/prayinforrain.github.io@main/static/styles/_giscus.css",giscus_dark="https://cdn.jsdelivr.net/gh/prayinforrain/prayinforrain.github.io@main/static/styles/_giscus_dark.css";let giscusTheme=localStorage.getItem("theme");giscusTheme||(giscusTheme="light",window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(defaultTheme="dark"));let giscusAttributes={src:"https://giscus.app/client.js","data-repo":"prayinforrain/prayinforrain.github.io","data-repo-id":"R_kgDOItUJmA","data-category":"Announcements","data-category-id":"DIC_kwDOItUJmM4CTXa0","data-mapping":"pathname","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":giscusTheme==="dark"?giscus_dark:giscus_light,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([e,t])=>giscusScript.setAttribute(e,t)),document.getElementById("giscus-wrapper").appendChild(giscusScript)</script></main></div><footer class=footer><span class=footer_item></span>&nbsp;<div class=footer_social-icons><a href=https://github.com/prayinforrain target=_blank rel="noopener noreferrer me" title=Github><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=mailto:prayinforrain@naver.com target=_blank rel="noopener noreferrer me" title=Email><svg viewBox="0 0 24 21" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
</a><a href=index.xml target=_blank rel="noopener noreferrer me" title=Rss><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div><small class=footer_copyright>© 2024 PrayinforRain.
Powered by <a href=https://github.com/hugo-sid/hugo-blog-awesome target=_blank rel="noreferrer noopener">Hugo blog awesome</a>
theme on
<a href=https://gohugo.io target=_blank rel="noreferrer noopener">Hugo</a>.</small></footer><a href=# title="Go to top" id=totop><svg width="48" height="48" fill="currentcolor" stroke="currentcolor" viewBox="0 96 960 960"><path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197z"/></svg>
</a><script src=https://prayinforrain.github.io/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30+lSNuSkl4QXuNyy8="></script><script src=https://prayinforrain.github.io/js/custom.min.d9a0ea0a65c1b01e922173e72cd81eedad8ae4b3ca9396e95f24b6e7d29a94c8.js integrity="sha256-2aDqCmXBsB6SIXPnLNge7a2K5LPKk5bpXyS259KalMg="></script></body></html>