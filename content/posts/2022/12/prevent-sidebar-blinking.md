---
title: "ì‚¬ì´ë“œë°”ì•¼ ê·¸ë§Œ ê¹œë¹¡ì—¬ë¼"
date: 2022-12-06T02:11:55+09:00
lastmod: 2022-12-06T02:11:55+09:00
draft: false
categories: ["moheyum"]
tags: ["moheyum"]
---

**ëª¨í—¤ìœ°**ì˜ í”„ë¡ íŠ¸ì—”ë“œ ì•±ì€ `Next.js`ë¡œ ë§Œë“¤ì–´ì ¸ ìˆìŠµë‹ˆë‹¤. íŒ€ì› ê·¸ ëˆ„êµ¬ë„ ì‚¬ìš©í•´ ë³¸ ì ì´ ì—†ìŒì—ë„ êµ³ì´ ì„ íƒí•œ ì´ìœ ëŠ” `NestJS`ë¥¼ ì¨ ë³´ë‹ˆ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ í˜‘ì—… í™˜ê²½ì—ì„œ ì½”ë“œ ì¼ê´€ì„±ì„ ì§€í‚¤ëŠ” ë° ë„ì›€ì„ ì¤„ ê²ƒì´ë¼ëŠ” ë§‰ì—°í•œ ê¸°ëŒ€ì™€, `SSR`ì„ ì²´í—˜í•´ ë³´ê³  ì‹¶ì€ í•™ìŠµì ì¸ ìš•ì‹¬ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ì§€ê¸ˆ ëŒì•„ë³´ë‹ˆ â€˜ë„ˆì™€ í•¨ê»˜ í•˜ê¸¸ ì˜ í–ˆì–´!â€™ í•˜ëŠ” ê°ìƒì€ ì—†ë„¤ìš”.

ê¸°ì™• SSRì„ ì²´í—˜í•œë‹¤ê³  ì‹œì‘í•œ í”„ë¡œì íŠ¸ì¸ ë§Œí¼, ì„±ëŠ¥ì— ì‹ ê²½ì„ ì“°ì§€ ì•Šì„ ìˆ˜ ì—†ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‹¤ ì œê°€ ì¢‹ì•„í•˜ëŠ” ì–´ë–¤ íŒ€ì˜ ë…¸ì…˜ì—ì„œ `memoization`ì„ í†µí•œ ì»´í¬ë„ŒíŠ¸ ì¤‘ë³µ ë Œë”ë§ ë°©ì§€ì— ëŒ€í•œ ê¸€ì„ ì½ì—ˆëŠ”ë°ìš”, ì´ ë¶€ë¶„ì´ ë•Œ ë§ˆì¹¨ [Next.js 13ì„ ì ìš©í•˜ì§€ ëª»í•´ í¬ê¸°í•´ì•¼ë§Œ í–ˆë˜](https://www.notion.so/next-js-13-app-dir-11191a66a5564a25ba882c8a835afd13) ì•„í”ˆ ìƒì²˜ë¥¼ ìê·¹í•˜ê³  ìˆì–´ì„œ ëª¨í—¤ìœ°ì—ë„ ì‹œë„í•´ ë³´ê¸°ë¡œ í•˜ì˜€ìŠµë‹ˆë‹¤.

## ğŸ¤· TL;DR

- `useMemo`ë¡œ `memoization`í•˜ì—¬ë„ context ê°’ì„ ì°¸ì¡°í•˜ë©´ ë¦¬ë Œë”ë§ì´ ì´ë£¨ì–´ì§„ë‹¤.
- í¬ë¡¬ ê°œë°œì ë„êµ¬ë‚˜ React DevToolsë¥¼ í†µí•´ ë¦¬ë Œë”ë§ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
- `Next.js`ì—ì„œ `/pages/_app.tsx`ì— ë“¤ì–´ê°„ ì»´í¬ë„ŒíŠ¸ëŠ” ë¦¬ë Œë”ë§ì´ ë°©ì§€ëœë‹¤.

## ğŸ¤” ì‚¬ì´ë“œë°”ì˜ í˜„ì¬ ìƒí™©

ëª¨í—¤ìœ°ì€ Next.jsê°€ ìš”êµ¬í•˜ëŠ” ëŒ€ë¡œ pages ë””ë ‰í† ë¦¬ì— ê° í˜ì´ì§€ì˜ ë ˆì´ì•„ì›ƒì„ ì»´í¬ë„ŒíŠ¸ì˜ ì¡°í•©ìœ¼ë¡œ êµ¬ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì½”ë“œì²˜ëŸ¼ìš”.

```tsx
// index.tsx
export default function Home() {
  return (
    <AuthGuard>
      <Frame>
        <SideBar />
        <MainSection />
      </Frame>
    </AuthGuard>
  );
}
```

í•˜ì§€ë§Œ ì´ëŸ° ì‹ì˜ êµ¬í˜„ì€ í•œ ê°€ì§€ ê²°í•¨ì´ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ êµ¬í˜„ ê²°ê³¼ë¥¼ ë³´ë©´..

![befe.gif](/images/posts/2022/12/prevent-sidebar-blinking/01-sidebar-blinking.gif)

ë°”ë¡œ ì‚¬ì´ë“œë°”ê°€ ê° í˜ì´ì§€ë§ˆë‹¤ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë¡œ ì‚½ì…ë˜ì–´ **ë¼ìš°íŒ…ì´ ì¼ì–´ë‚  ë•Œ ë§ˆë‹¤ ìƒˆë¡­ê²Œ ë Œë”ë§**ì´ ë˜ê³  ìˆë‹¤ëŠ” ë¬¸ì œì¸ë°ìš”, ì–´ì°¨í”¼ ë˜‘ê°™ì´ ìƒê¸´ ì‚¬ì´ë“œë°”ì¸ë° ëª‡ ë²ˆì´ê³  ë‹¤ì‹œ ë Œë”ë§ í•˜ê²Œ ë˜ëŠ” ê²ƒì€ ë¹„íš¨ìœ¨ ì ì¼ ë¿ ì•„ë‹ˆë¼, ì›€ì§¤ì—ì„œ ë³´ì´ë“¯ì´ ìˆœê°„ì ì¸ ê¹œë¹¡ì„ì´ ê³„ì†ë˜ê³  ìˆëŠ” ìƒí™©ì…ë‹ˆë‹¤. ì•„ì§ ê¸°ëŠ¥ì´ ë§ì§€ ì•Šì•„ ë Œë”ë§ ëª‡ ë²ˆ ë” í•œë‹¤ê³  ì–µìš¸í•  ë¬¸ì œëŠ” ì•„ë‹ˆì§€ë§Œ ê¹œë¹¡ì„ì€ ì¡°ê¸ˆ ì°¸ê¸°ê°€ í˜ë“¤êµ°ìš”.

## ğŸ“ ë©”ëª¨ì•¼ ë„ì™€ì¤˜

ë¬´ì—‡ì´ ë¬¸ì œì¼ê¹Œìš”? ì¼ë‹¨ ì €ëŠ” ì•ì—ì„œ ì–¸ê¸‰í•œ ê¸€ì´ ì„¤ëª…í•œ ëŒ€ë¡œ `useMemo`ë¥¼ í†µí•´ ì‚¬ì´ë“œë°”ë¥¼ `memoize`í•˜ë©´ ë¦¬ë Œë”ë§ì„ ë©ˆì¶”ì§€ ì•Šì„ê¹Œ í•˜ëŠ” ìƒê°ì— ì‚¬ì´ë“œë°” ì»´í¬ë„ŒíŠ¸ë¥¼ ëª¨ì¡°ë¦¬ Memoë¡œ ë³€ê²½í•˜ì˜€ìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ê³  ë³´ë‹ˆ ë¦¬ë Œë”ë§ì´ ì´ë£¨ì–´ì§€ëŠ” ì§€ë¥¼ ì¡°ê¸ˆ ë” ì •í™•í•˜ê²Œ í™•ì¸í•  ë°©ë²•ì´ ì—†ì„ê¹Œìš”? ë¦¬ì•¡íŠ¸ì—ì„œ ì œê³µí•˜ëŠ” `React Devtools`ë¥¼ ì‚¬ìš©í•˜ë©´ ë Œë”ë§ì´ ì´ë£¨ì–´ì§€ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ í‘œì‹œí•  ìˆ˜ ìˆë‹¤ê³  í•©ë‹ˆë‹¤. í•œë²ˆ ì ìš©í•´ì„œ ê°™ì´ í™•ì¸í•´ ë³´ê² ìŠµë‹ˆë‹¤.

![memo.gif](/images/posts/2022/12/prevent-sidebar-blinking/02-sidebar-blinking.gif)

ìŒ.. ì´ˆë¡ ì„ ì´ ë§ˆêµ¬ ê·¸ì–´ ì§€ëŠ” ê±¸ ë³´ë‹ˆ ë Œë”ë§ë„ ì´ë£¨ì–´ì§€ê³  ìˆê³ , ì‹¤ì œë¡œë„ ê¹œë¹¡ì„ì´ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ê²°êµ­ 2022ë…„ì— ì‚¬ì´ë“œë°”ê°€ ê¹œë¹¡ì´ëŠ” ì›¹ì„ ë§Œë“œëŠ” ê°œë°œìê°€ ë  ìˆ˜ ë°–ì— ì—†ëŠ” ê±¸ê¹Œìš”? ì •ë§ ì†ìƒí•˜êµ°ìš”.

ê·¸ëŸ°ë° ì œê°€ ë´¤ë˜ ê¸€ì—ëŠ” ì´ëŸ° ë‚´ìš©ì´ ìˆì—ˆìŠµë‹ˆë‹¤.

> `Context`ì˜ ê°’ì„ ì°¸ì¡°í•˜ê³  ìˆë‹¤ë©´ `React.memo`ë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ `memoizaton`í•´ë„ ë¦¬ë Œë”ë§ì´ ë°œìƒí•´ìš”.

ì‚¬ì´ë“œë°”ì—ì„œ `Recoil`ì„ í†µí•´ ì „ì—­ ë³€ìˆ˜ë¥¼ ì°¸ì¡°í•˜ëŠ” ë¶€ë¶„ì´ ìˆì—ˆì§€ë§Œ ì´ë¥¼ ì œê±°í•˜ê³  í…ŒìŠ¤íŠ¸í•´ë´ë„ ì—¬ì „íˆ ê²°ê³¼ëŠ” ë˜‘ê°™ì•˜ê³ , ì €ëŠ” ê²°êµ­ `Next.js 13`ë•Œ `CSS-in-JS`ê°€ `Context API`ë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ì´ì•¼ê¸°ë¥¼ ë“¤ì—ˆë˜ ê¸°ì–µì´ ë– ì˜¬ë¼, ê²°êµ­ ìš°ë¦¬ëŠ” ë˜ `Emotion`ë•Œë¬¸ì— í•˜ë‚˜ì˜ í¬ë§ì„ í¬ê¸°í•˜ê²Œ ë˜ëŠ”êµ¬ë‚˜, í•˜ê³  ì²´ë…ì„ í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ëª¨ì…˜ ìš”ë†ˆ í•˜ë‚˜ ë•Œë¬¸ì— ìƒê²Œ ë˜ëŠ” ê²ƒì´ ì •ë§ ë§êµ°ìš”.

## â¡ï¸ Nextì•¼ ë‚˜ëŠ” ë„ˆë¥¼ ë¯¿ì—ˆì–´

í•˜ì§€ë§Œ ì—¬ê¸°ì„œ í¬ê¸°í•˜ë©´ ì—¬íƒœ ì“´ ê¸€ê³¼ ì‹œê°„ì´ ë„ˆë¬´ ì•„ê¹Œì› ìŠµë‹ˆë‹¤. ìƒˆ ì´ìŠˆë¥¼ ì²˜ë¦¬í•˜ê¸°ì—” ì‹œê°„ì´ ë„ˆë¬´ ì• ë§¤í–ˆê³  ì•„ì‰¬ìš´ ë§ˆìŒì— ê²€ìƒ‰ì„ í•˜ë˜ ì¤‘ ëª‡ ê°€ì§€ ê¸€ë“¤ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.

> You can wrap your page component with yourÂ `Layout`Â component insideÂ `_app.js`
> , it should prevent it from re-mounting.

ì •ë‹µì€ `Next.js`ê°€ ê°€ì§€ê³  ìˆì—ˆêµ°ìš”. ëª¨ë“  í˜ì´ì§€ë¥¼ ë Œë”ë§ í• ë•Œ ì‚¬ìš©ë˜ëŠ” `_app.tsx`ì— ë‹¬ì•„ ë†“ì€ ì»´í¬ë„ŒíŠ¸ëŠ” ë¦¬ë Œë”ë§ì´ ì´ë£¨ì–´ì§€ì§€ ì•ŠëŠ”ë‹¤ëŠ” ë‚´ìš©ì¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì´ë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ëª¨ë“  í˜ì´ì§€ì— ê°ê° ë‹¬ë ¤ìˆëŠ” `Frame`ê³¼ `SideBar` ì»´í¬ë„ŒíŠ¸ë¥¼ ì œê±°í•˜ê³  `_app.tsx`ë¡œ ì´ì „í•˜ëŠ” ì‘ì—…ì´ í•„ìš”í•œë°ìš”, ì´ë ‡ê²Œ í•˜ë©´ **ê³µí†µëœ ë ˆì´ì•„ì›ƒì„ ì ìš©í•˜ê¸° ìœ„í•´ ë¶ˆí•„ìš”í•˜ê²Œ ë°˜ë³µë˜ëŠ” ì½”ë“œì˜ ì–‘ì„ ì¤„ì¼ ìˆ˜ ìˆëŠ” ì´ì **ê¹Œì§€ ì±™ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
// _app.tsx
export default function App({ Component, pageProps }: AppProps) {
  return (
    <ThemeProvider theme={theme}>
      <RecoilRoot>
        <Global styles={globalStyle} />
        <AppStyle>
          <Head>
            <title>Moheyum</title>
          </Head>
          <Component {...pageProps} />
        </AppStyle>
      </RecoilRoot>
    </ThemeProvider>
  );
}
```

ë°”ë¡œ ìˆ˜ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì§€ê¸ˆ `_app.tsx`ëŠ” ìœ„ì™€ ê°™ì€ ìƒíƒœì…ë‹ˆë‹¤. ì—¬ê¸°ì— ë ˆì´ì•„ì›ƒì˜ ì˜ì—­ì„ ì œí•œí•˜ëŠ” `Frame`ê³¼ ì˜¤ëŠ˜ì˜ ì£¼ì¸ê³µì¸ `SideBar` ì»´í¬ë„ŒíŠ¸ë¥¼ ì¶”ê°€í•˜ë˜, ë¡œê·¸ì¸ê³¼ íšŒì›ê°€ì… ë“± ì¼ë¶€ ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ì‚¬ì´ë“œë°”ê°€ ë³´ì—¬ì„œëŠ” ì•ˆë©ë‹ˆë‹¤. ì´ ë¶€ë¶„ì€ `Router.pathname`ìœ¼ë¡œ ëŒ€ì¡°í•˜ì—¬ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```tsx
// _app.tsx
const NoSideBar = ["/login", "/signup"];

export default function App({ Component, pageProps }: AppProps) {
  const router = useRouter();
  return (
    <ThemeProvider theme={theme}>
      <RecoilRoot>
        <Global styles={globalStyle} />
        <AppStyle>
          <Head>
            <title>Moheyum</title>
          </Head>
          <Frame>
            {!NoSideBar.includes(router.pathname) && <SideBar />}
            <ComponentWrapper>
              <Component {...pageProps} />
            </ComponentWrapper>
          </Frame>
        </AppStyle>
      </RecoilRoot>
    </ThemeProvider>
  );
}
```

`_app.tsx`ë¥¼ ìˆ˜ì •í•˜ê³ , `pages` ë””ë ‰í† ë¦¬ ì•ˆì˜ ëª¨ë“  `SideBar`ë¥¼ importí•˜ëŠ” ë¶€ë¶„ì„ ì œê±°í–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ ìˆ˜ê°€ ë” ë§ì•„ì§€ê³  ë‚˜ì„œ í–ˆìœ¼ë©´ ì†ëª©ì— ë¬´ë¦¬ê°€ ì™”ì„ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤.

> ğŸ’¡ **CSS-in-JSëŠ” React DevToolsì—ì„œ ë Œë”ë§ ì •ë³´ë¥¼ ì˜ëª» ë³´ì—¬ì¤€ë‹¤?**  
> ì •í™•í•˜ì§€ëŠ” ì•Šì€ ì •ë³´ì´ì§€ë§Œ, React DevToolsê°€ ë³´ì—¬ì£¼ëŠ” ë¦¬ë Œë”ë§ ì •ë³´ê°€ ì‹¤ì œ ë¸Œë¼ìš°ì €ì˜ ë¦¬ë Œë”ë§ê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤ëŠ” ê¸€ì„ ë´¤ìŠµë‹ˆë‹¤. ì‹¤ì œ ë¦¬ë Œë”ë§ ìƒí™©ì„ ë³´ê¸° ìœ„í•´ì„œëŠ” í¬ë¡¬ ê°œë°œì ë„êµ¬ì˜ `ë Œë”ë§ â†’ í˜ì¸íŠ¸ í”Œë˜ì‹œ`ë¥¼ ì²´í¬í•´ì„œ í™•ì¸í•˜ë¼ê³  í•˜ë„¤ìš”.  
> ë¦¬ì•¡íŠ¸ ë°ë¸Œíˆ´ê³¼ì˜ ì°¨ì´ëŠ” ë¦¬ì•¡íŠ¸ì˜ virtual renderì™€ ë¸Œë¼ìš°ì €ì˜ native rerenderë¥¼ ë³´ì—¬ì£¼ëŠ” ì°¨ì´ë¼ê³  í•˜ëŠ”ë°, ì¢€ ë” ì•Œì•„ë³¼ í•„ìš”ê°€ ìˆì–´ ë³´ì…ë‹ˆë‹¤.  
> ![Untitled](/images/posts/2022/12/prevent-sidebar-blinking/03-sidebar-blinking.png)

![aftr.gif](/images/posts/2022/12/prevent-sidebar-blinking/04-sidebar-blinking.gif)

ë¸Œë¼ìš°ì €ì˜ í˜ì¸íŠ¸ í”Œë˜ì‹œë¥¼ ì²´í¬í•˜ê³  í™•ì¸í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. gif íŒŒì¼ì„ ê³„ì† í•˜ì´ë¼ì´íŠ¸í•´ì„œ ì •ì‹ ì´ ì‚¬ë‚©ì§€ë§Œ, ì•„ë¬´íŠ¼ ìš°ì¸¡ì˜ ë©”ì¸ ì„¹ì…˜ì´ ê³„ì† ë¦¬ë Œë”ë§ ë˜ëŠ” ë™ì•ˆ ì‚¬ì´ë“œë°” ë§Œí¼ì€ í•œ ë²ˆì˜ ê¹œë¹¡ê±°ë¦¼ ì—†ì´ ê¹”ë”í•˜ê²Œ ì‘ë™í•¨ì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ì œ ì¢€ ë‚«ë„¤ìš”!

## ğŸ“– Refs.

[re rendering conditions](https://velog.io/@gth1123/re-rendering-conditions)  
[Next js how to avoid re-rendering of common components between routed pages?](https://stackoverflow.com/questions/70531347/next-js-how-to-avoid-re-rendering-of-common-components-between-routed-pages)  
[NEXT JS - How to prevent layout get re-mounted?](https://stackoverflow.com/questions/59519286/next-js-how-to-prevent-layout-get-re-mounted)  
[How to prevent parent component from re-rendering with React (next.js) SSR two-pass rendering?](https://stackoverflow.com/questions/58987174/how-to-prevent-parent-component-from-re-rendering-with-react-next-js-ssr-two-p)  
[ë„¤?? Componentë¥¼ memoizationí•´ë„ ë¦¬ë Œë”ë§ì´ ë°œìƒí•œë‹¤êµ¬ìš”..?? ğŸ’¦ (feat. context)](https://www.notion.so/Component-memoization-feat-context-a4a73e27d15343e6b518a77c0c9d92b3)
